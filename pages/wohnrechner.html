<!-- Section: Wohn-Rechner -->
<section id="wohnrechner">
    <div class="section-header">
        <h4>Rechner</h4>
        <h2>Wohnen: Mieten vs. Kaufen</h2>
        <p>Vergleiche die Auswirkungen auf dein Verm√∂gen √ºber Zeit. Was lohnt sich langfristig mehr?</p>
    </div>

    <div class="bento-grid">
        <!-- Affordability Warning Banner (hidden by default) -->
        <div class="card card-full affordability-warning" id="affordabilityWarning" style="display: none;">
            <div class="warning-banner">
                <div class="warning-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                        <line x1="12" y1="9" x2="12" y2="13"/>
                        <line x1="12" y1="17" x2="12.01" y2="17"/>
                    </svg>
                </div>
                <div class="warning-content">
                    <div class="warning-title">Tragbarkeit nicht gegeben</div>
                    <div class="warning-text" id="affordabilityText">Die Wohnkosten √ºbersteigen 33% deines Einkommens. Schweizer Banken werden diese Finanzierung wahrscheinlich ablehnen.</div>
                </div>
            </div>
        </div>

        <!-- Calculator Inputs - Full Width with 2 Columns -->
        <div class="card card-full">
            <h3>Deine Ausgangslage</h3>

            <div class="calculator-inputs-grid">
                <!-- Left Column: Property -->
                <div class="input-column">
                    <div class="input-column-header">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                            <polyline points="9 22 9 12 15 12 15 22"/>
                        </svg>
                        Immobilie
                    </div>

                    <div class="input-group">
                        <label for="propertyPrice">
                            Kaufpreis
                            <span class="value-display" id="propertyPriceDisplay">CHF 800'000</span>
                        </label>
                        <input type="range" id="propertyPrice" value="800000" min="200000" max="3000000" step="25000">
                    </div>

                    <div class="input-group">
                        <label for="downPayment">
                            Eigenkapital
                            <span class="value-display" id="downPaymentDisplay">CHF 200'000</span>
                        </label>
                        <input type="range" id="downPayment" value="200000" min="50000" max="1000000" step="10000">
                    </div>

                    <div class="input-row">
                        <div class="input-group input-group-half">
                            <label for="purchaseCosts">
                                Kaufnebenkosten
                                <span class="value-display" id="purchaseCostsDisplay">5.0%</span>
                            </label>
                            <input type="range" id="purchaseCosts" value="5" min="3" max="8" step="0.5">
                        </div>

                        <div class="input-group input-group-half">
                            <label for="appreciation">
                                Wertsteigerung p.a.
                                <span class="value-display" id="appreciationDisplay">1.5%</span>
                            </label>
                            <input type="range" id="appreciation" value="1.5" min="0" max="4" step="0.25">
                        </div>
                    </div>

                    <div class="input-group">
                        <label for="maintenanceCost">
                            Unterhaltskosten/Jahr
                            <span class="value-display" id="maintenanceCostDisplay">CHF 8'000</span>
                        </label>
                        <input type="range" id="maintenanceCost" value="8000" min="2000" max="20000" step="500">
                    </div>
                </div>

                <!-- Right Column: Financing & Rent -->
                <div class="input-column">
                    <div class="input-column-header">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                        </svg>
                        Finanzierung & Miete
                    </div>

                    <div class="input-row">
                        <div class="input-group input-group-half">
                            <label for="mortgageRate">
                                Hypothekzins
                                <span class="value-display" id="mortgageRateDisplay">2.0%</span>
                            </label>
                            <input type="range" id="mortgageRate" value="2" min="0.5" max="5" step="0.1">
                        </div>

                        <div class="input-group input-group-half">
                            <label for="amortYears">
                                Amortisation
                                <span class="value-display" id="amortYearsDisplay">15 Jahre</span>
                            </label>
                            <input type="range" id="amortYears" value="15" min="5" max="25" step="1">
                        </div>
                    </div>

                    <div class="input-row">
                        <div class="input-group input-group-half">
                            <label for="monthlyRent">
                                Monatsmiete (kalt)
                                <span class="value-display" id="monthlyRentDisplay">CHF 2'500</span>
                            </label>
                            <input type="range" id="monthlyRent" value="2500" min="500" max="8000" step="100">
                        </div>

                        <div class="input-group input-group-half">
                            <label for="rentIncrease">
                                Mietsteigerung p.a.
                                <span class="value-display" id="rentIncreaseDisplay">1.5%</span>
                            </label>
                            <input type="range" id="rentIncrease" value="1.5" min="0" max="4" step="0.25">
                        </div>
                    </div>

                    <div class="input-row">
                        <div class="input-group input-group-half">
                            <label for="investReturn">
                                Anlagerendite
                                <span class="value-display" id="investReturnDisplay">5.0%</span>
                            </label>
                            <input type="range" id="investReturn" value="5" min="0" max="10" step="0.5">
                        </div>

                        <div class="input-group input-group-half">
                            <label for="duration">
                                Betrachtungszeitraum
                                <span class="value-display" id="durationDisplay">20 Jahre</span>
                            </label>
                            <input type="range" id="duration" value="20" min="5" max="40" step="5">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tax inputs row -->
            <div class="calculator-inputs-grid" style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid var(--border);">
                <div class="input-column">
                    <div class="input-column-header">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                            <polyline points="14 2 14 8 20 8"/>
                            <line x1="16" y1="13" x2="8" y2="13"/>
                            <line x1="16" y1="17" x2="8" y2="17"/>
                        </svg>
                        Steuern (Schweiz)
                    </div>

                    <div class="input-row">
                        <div class="input-group input-group-half">
                            <label for="taxRate">
                                Grenzsteuersatz
                                <span class="value-display" id="taxRateDisplay">30%</span>
                            </label>
                            <input type="range" id="taxRate" value="30" min="15" max="45" step="1">
                        </div>

                        <div class="input-group input-group-half">
                            <label for="grossIncome">
                                Bruttoeinkommen
                                <span class="value-display" id="grossIncomeDisplay">CHF 120'000</span>
                            </label>
                            <input type="range" id="grossIncome" value="120000" min="50000" max="500000" step="10000">
                        </div>
                    </div>
                </div>
                <div class="input-column" style="display: flex; align-items: center; justify-content: center;">
                    <p style="color: var(--text-muted); font-size: 0.85rem; text-align: center;">
                        <strong>Hinweis:</strong> Eigenmietwert, Hypothekarzinsabzug und Unterhaltsabzug werden automatisch berechnet.
                    </p>
                </div>
            </div>
        </div>

        <!-- Results with Recommendation Banner -->
        <div class="card card-full">
            <!-- Recommendation Banner -->
            <div class="recommendation-banner" id="recommendationBanner">
                <div class="recommendation-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
                    </svg>
                </div>
                <div class="recommendation-content">
                    <div class="recommendation-title">Ergebnis nach <span id="resultDuration">20</span> Jahren</div>
                    <div class="recommendation-text" id="recommendation">Berechnung l√§uft...</div>
                </div>
            </div>

            <h3 style="margin-top: 1.5rem;">Detaillierter Vergleich</h3>

            <div class="comparison-panels">
                <!-- Kaufen Panel -->
                <div class="comparison-panel panel-kaufen" id="panelKaufen">
                    <div class="panel-header">
                        <h4><span class="emoji">üè†</span> Kaufen</h4>
                        <span class="panel-badge" id="kaufenBadge" style="display:none;">Beste Option</span>
                    </div>
                    <div class="panel-body">
                        <div class="panel-section">
                            <h5>Initialkosten</h5>
                            <div class="breakdown-row">
                                <span>Eigenkapital</span>
                                <span id="kaufenEigenkapital">CHF 200'000</span>
                            </div>
                            <div class="breakdown-row breakdown-total">
                                <span>Kaufnebenkosten</span>
                                <span id="kaufenNebenkosten">CHF 40'000</span>
                            </div>
                        </div>
                        <div class="panel-section">
                            <h5>Monatliche Kosten (Durchschnitt)</h5>
                            <div class="breakdown-row">
                                <span>Hypothekzins</span>
                                <span id="kaufenZins">CHF 1'000/Mt.</span>
                            </div>
                            <div class="breakdown-row">
                                <span>Amortisation</span>
                                <span id="kaufenAmort">CHF 667/Mt.</span>
                            </div>
                            <div class="breakdown-row">
                                <span>Unterhalt</span>
                                <span id="kaufenUnterhalt">CHF 667/Mt.</span>
                            </div>
                            <div class="breakdown-row">
                                <span>Steuereffekt</span>
                                <span id="kaufenSteuer">-CHF 200/Mt.</span>
                            </div>
                            <div class="breakdown-row breakdown-total">
                                <span>Total monatlich</span>
                                <span id="kaufenMonatlich">CHF 2'134/Mt.</span>
                            </div>
                        </div>
                        <div class="panel-section">
                            <h5>Verm√∂gen am Ende</h5>
                            <div class="breakdown-row">
                                <span>Immobilienwert</span>
                                <span id="kaufenImmowert">CHF 1'072'000</span>
                            </div>
                            <div class="breakdown-row">
                                <span>Restschuld</span>
                                <span class="negative" id="kaufenRestschuld">-CHF 520'000</span>
                            </div>
                            <div class="breakdown-row breakdown-total positive">
                                <span>Netto-Eigenkapital</span>
                                <span id="kaufenTotal">CHF 552'000</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Mieten Panel -->
                <div class="comparison-panel panel-mieten" id="panelMieten">
                    <div class="panel-header">
                        <h4><span class="emoji">üîë</span> Mieten</h4>
                        <span class="panel-badge panel-badge-warning" id="mietenBadge" style="display:none;">Flexibel</span>
                    </div>
                    <div class="panel-body">
                        <div class="panel-section">
                            <h5>Monatliche Kosten</h5>
                            <div class="breakdown-row">
                                <span>Startmiete</span>
                                <span id="mietenStart">CHF 2'500/Mt.</span>
                            </div>
                            <div class="breakdown-row">
                                <span>Miete Jahr <span id="mietenEndYear">20</span></span>
                                <span id="mietenEnd">CHF 3'360/Mt.</span>
                            </div>
                            <div class="breakdown-row breakdown-total">
                                <span>Total Miete bezahlt</span>
                                <span id="mietenTotalPaid">CHF 696'000</span>
                            </div>
                        </div>
                        <div class="panel-section">
                            <h5>Verm√∂gen am Ende</h5>
                            <div class="breakdown-row">
                                <span>Investiertes Portfolio</span>
                                <span id="mietenPortfolio">CHF 530'000</span>
                            </div>
                            <div class="breakdown-row" style="color: var(--text-muted);">
                                <span>Immobilien-Eigentum</span>
                                <span>CHF 0</span>
                            </div>
                            <div class="breakdown-row breakdown-total positive">
                                <span>Gesamtverm√∂gen</span>
                                <span id="mietenTotal">CHF 530'000</span>
                            </div>
                        </div>
                        <div class="panel-section">
                            <h5>Strategie</h5>
                            <div class="breakdown-row" style="color: var(--text-muted); font-size: 0.85rem;">
                                <span>Eigenkapital investiert, kein Eigentum aufgebaut</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Mieten + Maximal Sparen Panel -->
                <div class="comparison-panel panel-mieten-max" id="panelMietenMax">
                    <div class="panel-header">
                        <h4><span class="emoji">üìà</span> Mieten + Sparen</h4>
                        <span class="panel-badge panel-badge-neutral" id="mietenMaxBadge" style="display:none;">Maximales Sparen</span>
                    </div>
                    <div class="panel-body">
                        <div class="panel-section">
                            <h5>Investiertes Startkapital</h5>
                            <div class="breakdown-row">
                                <span>Eigenkapital</span>
                                <span id="mietenMaxEK">CHF 200'000</span>
                            </div>
                            <div class="breakdown-row breakdown-total">
                                <span>+ Kaufnebenkosten</span>
                                <span id="mietenMaxNK">CHF 40'000</span>
                            </div>
                        </div>
                        <div class="panel-section">
                            <h5>Zus√§tzliche Sparrate</h5>
                            <div class="breakdown-row">
                                <span>Differenz Kaufen vs. Mieten</span>
                                <span id="mietenMaxSparrate">CHF 0/Mt.</span>
                            </div>
                            <div class="breakdown-row" style="color: var(--text-muted); font-size: 0.85rem;">
                                <span>Falls Kaufen teurer ist, wird die Differenz investiert</span>
                            </div>
                        </div>
                        <div class="panel-section">
                            <h5>Verm√∂gen am Ende</h5>
                            <div class="breakdown-row">
                                <span>Portfolio-Endwert</span>
                                <span id="mietenMaxPortfolio">CHF 637'000</span>
                            </div>
                            <div class="breakdown-row breakdown-total positive">
                                <span>Gesamtverm√∂gen</span>
                                <span id="mietenMaxTotal">CHF 637'000</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chart with Tabs -->
        <div class="card card-full">
            <h3>Verm√∂gensentwicklung √ºber Zeit</h3>
            <p style="color: var(--text-muted); margin-bottom: 1rem;">Klicke auf die Tabs um die Zusammensetzung jeder Option zu sehen.</p>

            <div class="chart-tabs">
                <button class="chart-tab active" data-view="overview">
                    <svg class="chart-tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="20" x2="18" y2="10"></line>
                        <line x1="12" y1="20" x2="12" y2="4"></line>
                        <line x1="6" y1="20" x2="6" y2="14"></line>
                    </svg>
                    Vergleich
                </button>
                <button class="chart-tab" data-view="kaufen">
                    <svg class="chart-tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                        <polyline points="9 22 9 12 15 12 15 22"/>
                    </svg>
                    Kaufen
                </button>
                <button class="chart-tab" data-view="mieten">
                    <svg class="chart-tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"/>
                        <polyline points="10 17 15 12 10 7"/>
                        <line x1="15" y1="12" x2="3" y2="12"/>
                    </svg>
                    Mieten
                </button>
                <button class="chart-tab" data-view="mietenMax">
                    <svg class="chart-tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/>
                        <polyline points="17 6 23 6 23 12"/>
                    </svg>
                    Mieten+Sparen
                </button>
            </div>

            <div class="chart-container" style="height: 350px;">
                <canvas id="wohnComparisonChart"></canvas>
            </div>
        </div>

        <!-- Explanation Cards -->
        <div class="card card-sm">
            <h4 style="color: var(--success);">Kaufen</h4>
            <h3>Eigentum aufbauen</h3>
            <p>Du baust langfristig Verm√∂gen auf und profitierst von Wertsteigerung.</p>
            <ul class="feature-list">
                <li>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>
                    Inflationsschutz durch Sachwert
                </li>
                <li>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>
                    Steuervorteile (Abz√ºge)
                </li>
                <li>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="m15 9-6 6M9 9l6 6"/></svg>
                    Hohe Kapitalbindung
                </li>
            </ul>
        </div>

        <div class="card card-sm">
            <h4 style="color: var(--warning);">Mieten</h4>
            <h3>Flexibel bleiben</h3>
            <p>Kein Eigenkapital gebunden, volle Flexibilit√§t bei Wohnortwechsel.</p>
            <ul class="feature-list">
                <li>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>
                    Kapital frei investierbar
                </li>
                <li>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>
                    Keine Unterhaltskosten
                </li>
                <li>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="m15 9-6 6M9 9l6 6"/></svg>
                    Mietkosten steigen
                </li>
            </ul>
        </div>

        <div class="card card-sm">
            <h4 style="color: #3b82f6;">Steuereffekte</h4>
            <h3>Schweizer Besonderheit</h3>
            <p>Eigenmietwert vs. Hypothekarzinsabzug - was √ºberwiegt?</p>
            <ul class="feature-list">
                <li>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>
                    Eigenmietwert: ~3.5% des Werts
                </li>
                <li>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>
                    Zinsen & Unterhalt abziehbar
                </li>
                <li>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>
                    Anfangs oft Steuerersparnis
                </li>
            </ul>
        </div>

        <!-- Important Notes -->
        <div class="card card-full" style="background: linear-gradient(135deg, var(--bg-card) 0%, rgba(212, 175, 55, 0.08) 100%); border: 1px solid var(--border-accent);">
            <h3 style="color: var(--accent);">Wichtige Annahmen</h3>
            <ul class="feature-list">
                <li>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>
                    <strong>Eigenmietwert:</strong> 3.5% des Immobilienwerts (kantonale Unterschiede m√∂glich)
                </li>
                <li>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>
                    <strong>Schweizer Hypotheken:</strong> 1. Hypothek (65% LTV) oft nicht amortisiert, nur 2. Hypothek (80%‚Üí65%)
                </li>
                <li>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>
                    <strong>Tragbarkeit:</strong> Banken rechnen mit 5% Kalkulationszins + 1% Amortisation + 1% NK
                </li>
                <li>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>
                    <strong>Kapitalgewinne:</strong> In der Schweiz auf Aktien steuerfrei (Privatverm√∂gen)
                </li>
                <li>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>
                    <strong>Nebenkosten:</strong> Bei Miete inkl., bei Eigentum extra (Versicherung, Steuern, Reparaturen)
                </li>
                <li>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>
                    <strong>Kaufnebenkosten:</strong> Notarkosten, Grundbuchgeb√ºhren, Hand√§nderungssteuer (kantonsabh√§ngig)
                </li>
            </ul>
        </div>
    </div>
</section>
